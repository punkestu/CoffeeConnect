<div class="mt-2 p-2">
    {{#unless editMode}}
        <div class="flex items-end justify-between gap-3 mb-2">
            <div class="flex items-end gap-3 mb-2">
                <h1>{{kedai.name}}</h1>
                {{#ifEq kedai.user.username user.username}}
                    <a href="/editkedai" class="link">Edit</a>
                {{/ifEq}}
            </div>
            {{#ifEq kedai.user.username user.username}}
                <a href="/formproduk" class="btn btn-primary"><span class="text-lg font-bold">+</span> Create Menu</a>
            {{/ifEq}}
        </div>
        <div class="flex flex-col gap-2 ps-5">
            <p class="text-slate-600">{{kedai.address}}</p>
            <a href="http://wa.me/{{kedai.phone}}" class="link self-start">Contact me: {{kedai.phone}}</a>
            <div class="flex flex-col items-center gap-2">
                <p id="bio" class="text-left w-full"></p>
                <button id="expandBtn" class="rounded px-2 bg-slate-300 text-slate-700 text w-1/3" onclick="expand()">
                    expand
                </button>
            </div>
        </div>
        <hr class="mt-2"/>
        <div class="mt-2 gap-2 flex flex-wrap">
            {{#eachProduk this kedai.Produk}}
                <div class="flex flex-col items-start w-[49.385%] lg:w-[24.55%] border rounded-lg">
                    <div class="p-2 flex justify-end w-full">
                        <button data-dropdown-toggle="dropdown" class="self-end">
                            <span class="material-symbols-rounded">more_vert</span>
                        </button>
                    </div>
                    <div id="dropdown"
                         class="z-10 hidden bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700">
                        <ul class="p-2 text-sm text-gray-700 dark:text-gray-200"
                            aria-labelledby="dropdownDefaultButton">
                            <li class="hover:bg-slate-50">
                                <button onclick="copyCB('/produk/{{kedai.name}}/{{Id}}')"
                                        class="block px-4 py-2 text-slate-700 flex items-center gap-1">
                                    <span class="material-symbols-rounded">share</span>
                                    Share
                                </button>
                            </li>
                            {{#ifEq user.Id kedai.user.Id}}
                                <hr>
                                <li class="hover:bg-slate-50">
                                    <a href="/edit/{{kedai.name}}/{{Id}}"
                                       class="block px-4 py-2 text-slate-700 flex items-center gap-1">
                                        <span class="material-symbols-rounded">edit</span>
                                        Edit
                                    </a>
                                </li>
                                <hr>
                                <li class="hover:bg-slate-50">
                                    <button data-modal-target="confirm-modal" data-modal-toggle="confirm-modal"
                                       class="block px-4 py-2 text-red-700 flex items-center gap-1">
                                        <span class="material-symbols-rounded">delete</span>
                                        <span>Delete</span>
                                    </button>
                                </li>
                            {{/ifEq}}
                        </ul>
                    </div>
                    <a href="/produk/{{kedai.name}}/{{Id}}" class="w-full p-2 pt-0">
                        <div class="w-full h-56 lg:h-64 flex justify-center bg-slate-100 mb-2 border">
                            <img class="object-cover" src="/picture/{{picture}}" alt="">
                        </div>
                        <h1 class="text-xl font-bold capitalize">{{name}}</h1>
                        <h2 class="text-slate-500 text-sm">Rp. {{price}}</h2>
                        <p>{{substr description 37}} <span class="text-slate-500">...</span></p>
                        <div class="mt-2 flex justify-between items-center gap-3 w-full">
                            <p class="flex gap-1 items-center text-slate-400">
                                <span class="material-symbols-rounded">comment</span>
                                99+
                            </p>
                            <p class="flex gap-1 items-center text-slate-400">
                                <span class="material-symbols-rounded">star</span>
                                5/5
                            </p>
                        </div>
                    </a>
                </div>

                <div id="confirm-modal" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
                    <div class="relative w-full max-w-md max-h-full">
                        <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                            <button type="button" class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-800 dark:hover:text-white" data-modal-hide="confirm-modal">
                                <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                                <span class="sr-only">Close modal</span>
                            </button>
                            <div class="p-6 text-center">
                                <svg aria-hidden="true" class="mx-auto mb-4 text-gray-400 w-14 h-14 dark:text-gray-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Are you sure you want to delete this product?</h3>
                                <a href="/delete/{{kedai.name}}/{{Id}}" class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2">
                                    Yes, I'm sure
                                </a>
                                <button data-modal-hide="confirm-modal" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">No, cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
            {{/eachProduk}}
        </div>
        <script>
            const bio = "{{kedai.description}}";
            var isExpand = false;

            function copyCB(link) {
                navigator.clipboard.writeText(link);
            }

            function expand() {
                const $bio = $("#bio");
                const $expandBtn = $("#expandBtn");
                if (isExpand) {
                    $bio.html(bio);
                    $expandBtn.html("close");
                } else {
                    $bio.html(bio.substring(0, 100) + "...");
                    $expandBtn.html("expand");
                }
                isExpand = !isExpand;
            }

            expand();
        </script>
    {{/unless}}
    {{#if editMode}}
        <form action="/k" method="POST" class="flex flex-col gap-2">
            <div class="flex justify-between items-stretch gap-5">
                <div class="flex-grow flex flex-col">
                    <label for="name" class="font-medium">Nama</label>
                    <input type="text" name="name" class="input-type" id="name" placeholder="Kedai name"
                           value="{{kedai.name}}"/>
                    <label for="address" class="font-medium">Alamat</label>
                    <textarea name="address" class="input-type" id="address" cols="30" rows="10"
                              placeholder="Address">{{kedai.address}}</textarea>
                    <label for="phone" class="font-medium">No Telepon</label>
                    <input type="tel" class="input-type" name="phone" id="phone" placeholder="Phone number"
                           value="{{kedai.phone}}"/>
                </div>
                <div class="flex-grow flex flex-col">
                    <label for="description" class="font-medium">Deskripsi</label>
                    <textarea name="description" class="input-type h-full" id="description" cols="30" rows="10"
                              placeholder="Description">{{kedai.description}}</textarea>
                </div>
            </div>
            <button class="btn btn-primary">Save</button>
        </form>
    {{/if}}
</div>