// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  Id            String         @id @default(uuid())
  full_name     String
  username      String         @unique
  email         String         @unique
  password      String
  role          Role           @relation(fields: [role_id], references: [Id])
  role_id       Int
  profile       User_Profile?
  Kedai_Profile Kedai_Profile?
}

model User_Profile {
  Id         String    @id @unique
  user       User      @relation(fields: [Id], references: [Id])
  birth_date DateTime?
  bio        String?
  address    String?
  phone      String?   @db.VarChar(15)
}

model Kedai_Profile {
  Id          String   @id @unique
  user        User     @relation(fields: [Id], references: [Id])
  name        String   @unique
  picture     String?
  description String
  address     String
  phone       String   @db.VarChar(15)
  produk      Produk[]
}

model Produk {
  Id          Int           @default(autoincrement())
  kedai       Kedai_Profile @relation(fields: [kedaiId], references: [Id])
  kedaiId     String
  name        String
  price       Int
  description String
  picture     String?
  updatedAt   DateTime      @default(now())
  bahan       Bahan[]

  @@id([Id, kedaiId])
}

model Bahan {
  Id            Int    @id @default(autoincrement())
  produk        Produk @relation(fields: [produkId, produkKedaiId], references: [Id, kedaiId])
  produkId      Int
  produkKedaiId String
  nama          String
  qty           Float
  satuan        Satuan @relation(fields: [satuanId], references: [Id])
  satuanId      Int
  harga         Int
  per           Float
}

model Satuan {
  Id    Int     @id @default(autoincrement())
  nama  String
  bahan Bahan[]
}

model Role {
  Id        Int    @id @default(autoincrement())
  role_name String @unique
  user      User[]
}
